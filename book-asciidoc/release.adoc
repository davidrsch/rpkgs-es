[[sec-release]]
= Subiendo a CRAN
:description: Aprenda a crear un paquete, la unidad fundamental de contenido compartible, reutilizable, y c√≥digo R reproducible.
:lang: es

Hemos estado se√±alando inquietudes espec√≠ficas de CRAN a lo largo del libro, en nuestro recorrido por las distintas partes de un paquete, como pruebas y ejemplos. En este cap√≠tulo, nos centramos en el proceso real de publicar un paquete en CRAN, por primera vez o como una actualizaci√≥n.

La expresi√≥n m√°s concreta de nuestro proceso de lanzamiento es la lista de verificaci√≥n producida por `usethis::use++_++release++_++issue()`, que abre una edici√≥n de GitHub que contiene una lista de tareas pendientes. Esta lista de verificaci√≥n evoluciona constantemente y responde a algunas caracter√≠sticas del paquete, as√≠ que no se sorprenda si ve algo un poco diferente de lo que mostramos aqu√≠. Las preocupaciones principales son bastante eternas y usaremos esta lista de verificaci√≥n para ayudar a estructurar este cap√≠tulo.

Pero primero: tenga en cuenta que se arrepentir√° profundamente si aborda la preparaci√≥n de su paquete para CRAN como una actividad separada que realiza _despu√©s_ de completar el desarrollo planificado para una versi√≥n. Este consejo es extremadamente relevante aqu√≠:

____
Si te duele, hazlo con m√°s frecuencia. ‚Äì Martin Fowlerfootnote:[La publicaci√≥n del blog de Fowler "`FrequencyReducesDifficulty`" es una excelente lectura sobre este tema, https://martinfowler.com/bliki/FrequencyReducesDifficulty.html.]
____

En el contexto actual, interprete que esto significa que debe ejecutar `R CMD check` con regularidad, preferiblemente en m√∫ltiples plataformas, y abordar r√°pidamente cualquier problema que surja. Recuerde que nuestra forma preferida de hacer esto es a trav√©s de `devtools::check()` (<<sec-workflow101-r-cmd-check>>).

¬øPor qu√© querr√≠as hacer algo que te resulta doloroso con m√°s frecuencia? Porque conduce a menos dolor en general. Primero, resolver 5 problemas es m√°s de 5 veces m√°s dif√≠cil que resolver 1. Es desmoralizador verse bloqueado por varios errores y la posibilidad de que se produzcan interacciones desagradables entre ellos hace que cada uno de ellos sea m√°s dif√≠cil de aislar y corregir. En segundo lugar, la retroalimentaci√≥n r√°pida tiende a reducir el n√∫mero total de errores. Una vez que aprenda alguna lecci√≥n de la manera m√°s dif√≠cil, es poco probable que cometa el mismo error docenas de veces en otras partes de su paquete. ¬°Finalmente, la pr√°ctica hace la perfecci√≥n! Con una mayor exposici√≥n, mejorar√° en la interpretaci√≥n y respuesta a los problemas que surjan en `R CMD check`.

Otra reacci√≥n natural es: ¬øpor qu√© no elimino este dolor por completo al no publicar mi paquete en CRAN? Para ciertos tipos de paquetes, esta puede ser la decisi√≥n correcta. Un ejemplo de ello es un paquete personal de funciones auxiliares. Otro ejemplo es un paquete que admite una organizaci√≥n espec√≠fica, siempre que tambi√©n tenga un m√©todo razonable para distribuir ese paquete a sus usuarios. La raz√≥n principal para tener su paquete en CRAN es darle mayor alcance. La gran mayor√≠a de los usuarios de R s√≥lo instalan paquetes de CRAN, ya sea por pol√≠tica personal o de la empresa o simplemente por falta de conocimiento sobre las alternativas. CRAN proporciona visibilidad, facilidad de instalaci√≥n y un sello de autenticidad. El proceso de env√≠o de CRAN puede ser frustrante, pero tiene muchas ventajas y este cap√≠tulo pretende hacerlo lo m√°s sencillo posible.

El proceso de liberaci√≥n que describimos aqu√≠ se utiliza mejor como una lista de verificaci√≥n previa al vuelo, que complementa sus esfuerzos continuos para mantener su paquete pasando la `R CMD check` de manera limpia y compatible con CRAN. Hay dos grandes descubrimientos que a menudo surgen con el proceso de lanzamiento de CRAN:

* Si ha estado haciendo la vista gorda ante las ADVERTENCIAS y ERRORES de `R CMD check`, realmente tiene que estudiarlos y eliminarlos ahora. Incluso deber√≠as eliminar tantas NOTAS como sea posible.
* Incluso si su paquete pasa limpiamente la `R CMD check` en su m√°quina, puede resultar revelador cuando abandona este entorno acogedor y familiar y, en cambio, es verificado en un servidor remoto, configurado por otra persona, ejecutando un sistema completamente diferente. Sistema operativo. Por eso es tan valioso utilizar un servicio de integraci√≥n continua como GitHub Actions (<<sec-sw-dev-practices-gha>>) para comprobar peri√≥dicamente su paquete en macOS, Windows y Linux.

Estos son los pasos principales en el proceso de liberaci√≥n:

[arabic]
. Determine el tipo de versi√≥n, que dicta el n√∫mero de versi√≥n.
. Si el paquete ya est√° en CRAN: realice la debida diligencia sobre los resultados de CRAN existentes. Si se trata de una primera versi√≥n: confirme que cumple con las pol√≠ticas de CRAN.
. Actualice los archivos de documentaci√≥n, como `README.md` y `NEWS.md`.
. Doble `check()` para que su paquete se transmita limpiamente en m√∫ltiples sistemas operativos y en la versi√≥n publicada y en desarrollo de R.
. Realice comprobaciones de dependencia inversa, si otros paquetes dependen del suyo.
. Env√≠e el paquete a CRAN y espere la aceptaci√≥n.
. Cree una versi√≥n de GitHub y prep√°rese para la pr√≥xima versi√≥n incrementando el n√∫mero de versi√≥n.
. Publicitar la nueva versi√≥n.

== Decidir el tipo de lanzamiento

Cuando llame a `use++_++release++_++issue()`, se le preguntar√° qu√© tipo de lanzamiento desea realizar.

[source,r,cell-code]
----
> use_release_issue()
‚úî Setting active project to '/Users/jenny/rrr/usethis'
Current version is 2.1.6.9000.
What should the release version be? (0 to exit) 

1: major --> 3.0.0
2: minor --> 2.2.0
3: patch --> 2.1.7

Selection: 
----

La pregunta inmediata parece bastante mec√°nica: ¬øqu√© componente del n√∫mero de versi√≥n desea incrementar? Pero recuerde que analizamos las diferencias sustanciales en los tipos de lanzamiento en <<sec-lifecycle-release-type>>.

En nuestro flujo de trabajo, este n√∫mero de versi√≥n planificada se registra en la edici√≥n de GitHub que contiene la lista de verificaci√≥n de lanzamiento, pero en realidad no incrementamos la versi√≥n en `DESCRIPTION` hasta m√°s adelante en el proceso (<<sec-release-process>>). Sin embargo, es importante declarar el tipo de versi√≥n por adelantado, porque el proceso (y, por lo tanto, la lista de verificaci√≥n) se ve diferente, por ejemplo, para una versi√≥n de parche versus una versi√≥n principal.

[[sec-release-initial]]
== Lanzamiento inicial de CRAN: consideraciones especiales

Cada nuevo paquete recibe un mayor nivel de escrutinio por parte de CRAN. Adem√°s de las habituales comprobaciones automatizadas, los nuevos paquetes tambi√©n son revisados por un humano, lo que inevitablemente introduce cierta subjetividad y aleatoriedad. Hay muchos paquetes en CRAN que no ser√≠an aceptados en su forma actual si se presentaran hoy como un paquete completamente nuevo. Esto no pretende desanimarte. Pero debe tener en cuenta que, s√≥lo porque vea algo de pr√°ctica en un paquete establecido (o incluso en base R), no significa que pueda hacer lo mismo en su nuevo paquete.

Afortunadamente, la comunidad mantiene listas de "`errores`" comunes para los nuevos paquetes. Si su paquete a√∫n no est√° en CRAN, la lista de verificaci√≥n comienza con una secci√≥n especial que refleja esta sabidur√≠a colectiva reciente. Prestar atenci√≥n a estos elementos de la lista de verificaci√≥n ha mejorado dr√°sticamente la tasa de √©xito de nuestro equipo en los env√≠os iniciales.

Primer lanzamiento

* [ ] `usethis::use++_++news++_++md()`
* [ ] `usethis::use++_++cran++_++comments()`
* [ ] Actualice (aspiracional) de las instrucciones de instalaci√≥n en `README`
* [ ] Revisar `Title:` y `Description:`
* [ ] Verifique que todas las funciones exportadas tengan `@returns` y `@examples`
* [ ] Compruebe que `Authors@R:` incluya un titular de derechos de autor (rol '`cph`')
* [ ] Verifique la licencia de los archivos incluidos
* [ ] Revisar https://github.com/DavisVaughan/extrachecks

Si a√∫n no tiene un archivo `NEWS.md`, le recomendamos que cree uno ahora con `usethis::use++_++news++_++md()`. Eventualmente querr√°s este archivo y esto anticipa el hecho de que la descripci√≥n de tu eventual versi√≥n de GitHub (<<sec-release-post-acceptance>>) se extrae de `NEWS.md`.

`usethis::use++_++cran++_++comments()` inicia un archivo para contener los comentarios de env√≠o de su paquete. Al principio es muy b√°sico, por ejemplo:

....
## R CMD check results

0 errors | 0 warnings | 1 note

* This is a new release.
....

En versiones posteriores, este archivo deja de tener sentido; por ejemplo, es donde informamos los resultados de las comprobaciones de dependencia inversa. Este no es un lugar para extenderse con largas explicaciones sobre su env√≠o. En general, deber√≠a eliminar la necesidad de tales explicaciones, especialmente para una presentaci√≥n inicial.

Recomendamos encarecidamente que su paquete tenga un archivo README (<<sec-readme>>). Si es as√≠, este es un buen momento para consultar las instrucciones de instalaci√≥n que se proporcionan all√≠. Es posible que deba cambiar las instrucciones para instalarlo desde GitHub a instalarlo desde CRAN, en anticipaci√≥n a la aceptaci√≥n de su paquete.

Los campos `Title` y `Description` de `DESCRIPTION` son verdaderos puntos cr√≠ticos durante la revisi√≥n humana de CRAN. Revise detenidamente los consejos proporcionados en <<sec-description-title-and-description>>. Compruebe tambi√©n que `Authors@R` incluya un titular de derechos de autor, indicado por la funci√≥n '`cph`'. Los dos escenarios m√°s comunes son que agrega '`cph`' a sus otros roles (probablemente '`cre`' y '`aut`') o que agrega su empleador a `Authors@R:` con '`cph`' y, tal vez, '`fnd`' role. (Cuando acredita a un financiador a trav√©s del rol '`fnd`', se reconoce en el pie de p√°gina de su sitio web pkgdown). Este tambi√©n es un buen momento para asegurarse de que la direcci√≥n de correo electr√≥nico del mantenedor sea apropiada. √âsta es la √∫nica manera en que CRAN puede comunicarse con usted. Si hay problemas y no pueden comunicarse con usted, eliminar√°n su paquete de CRAN. Aseg√∫rese de que esta direcci√≥n de correo electr√≥nico est√© disponible por un tiempo y que no est√© muy filtrada.

Verifique que cada una de sus funciones exportadas documente su valor de retorno (con la etiqueta `@returns`, <<sec-man-returns>>) y tenga una secci√≥n `@examples` (<<sec-man-examples>>). Si tiene ejemplos que no se pueden ejecutar en CRAN, es absolutamente necesario utilizar las t√©cnicas en <<sec-man-examples-dependencies-conditional-execution>> para expresar las condiciones previas relevantes correctamente. No tome atajos, como no tener ejemplos, comentar sus ejemplos o poner todos sus ejemplos dentro de `++\++dontrun++{++}`.

Si tiene c√≥digo de terceros incrustado en su paquete, verifique que cumple y declara correctamente su licencia (<<sec-code-you-bundle>>).

Finalmente, aproveche cualquier lista de comprobaciones _ad hoc_ que otros desarrolladores de paquetes hayan experimentado recientemente con CRAN. En el momento de escribir, https://github.com/DavisVaughan/extrachecks es un buen lugar para encontrar este tipo de informes de primera mano. Leer dicha lista y modificar preventivamente su paquete a menudo puede marcar la diferencia entre una aceptaci√≥n sin problemas y un proceso frustrante que requiere m√∫ltiples intentos.

=== Pol√≠ticas de CRAN

Le alertamos sobre pol√≠ticas CRAN espec√≠ficas a lo largo de este libro y, especialmente, a trav√©s de este cap√≠tulo. Sin embargo, se trata de un objetivo en movimiento, por lo que vale la pena hacer un esfuerzo para mantenerse informado sobre los cambios futuros en la pol√≠tica de CRAN.

El hogar oficial de la pol√≠tica CRAN es https://cran.r-project.org/web/packages/policies.html. Sin embargo, no es muy pr√°ctico leer este documento, por ejemplo, una vez a la semana y simplemente esperar notar alg√∫n cambio. El repositorio de GitHub https://github.com/eddelbuettel/crp[eddelbuettel/crp] monitorea la Pol√≠tica del repositorio de CRAN al rastrear la evoluci√≥n de los archivos subyacentes en la fuente del sitio web de CRAN. Por lo tanto, el historial de confirmaciones de ese repositorio hace que los cambios de pol√≠ticas sean mucho m√°s f√°ciles de navegar. Es posible que tambi√©n desee seguir la https://fosstodon.org/@cranpolicyWatch[cuenta de CRAN Policy Watch Mastodon], que suena cada vez que se detecta un cambio.footnote:[Durante muchos a√±os, existi√≥, en cambio, una https://twitter.com/CRANPolicyWatch[cuenta de Twitter de CRAN Policy Watch]. Pero gracias a los nuevos l√≠mites de acceso a la API para ese "`cad√°ver podrido de una plataforma`", la cuenta de Twitter ya no puede funcionar.]

La https://stat.ethz.ch/mailman/listinfo/r-package-devel[lista de correo de R-package-devel] es otro buen recurso para aprender m√°s sobre el desarrollo de paquetes. Puede suscribirse para estar al tanto de lo que hablan otros mantenedores. Incluso si no est√° suscrito, puede resultar √∫til buscar en esta lista cuando est√© investigando un tema espec√≠fico.

== Mantenerse al d√≠a con el cambio

Ahora pasamos a los elementos principales de la lista de verificaci√≥n para una versi√≥n menor o mayor de un paquete que ya est√° en CRAN. Muchos de estos elementos tambi√©n aparecen en la lista de verificaci√≥n de un parche o lanzamiento inicial.

* [ ] Verifique los resultados actuales de la verificaci√≥n CRAN
* [ ] Compruebe si se debe avanzar alg√∫n proceso de desaprobaci√≥n, como se describe en https://lifecycle.r-lib.org/articles/communicate.html#gradual-deprecation[Desaprobaci√≥n gradual]
* [ ] https://style.tidyverse.org/news.html#news-release[Pulir NEWS]
* [ ] `urlchecker::url++_++check()`
* [ ] `devtools::build++_++readme()`

Estos primeros elementos confirman que su paquete se mantiene al d√≠a con su entorno y consigo mismo. El primer elemento, "`Verificar los resultados actuales de la verificaci√≥n de CRAN`", ser√° un hiperv√≠nculo a los resultados de la verificaci√≥n de CRAN para la versi√≥n del paquete que se encuentra actualmente en CRAN. Si hay ADVERTENCIAS, ERRORES o NOTAS all√≠, debe investigar y determinar qu√© est√° pasando. Ocasionalmente puede haber un problema intermitente en CRAN, pero en t√©rminos generales, cualquier resultado que no sea "`OK`" es algo que debe abordar con la versi√≥n que est√° preparando. Es posible que descubra que su paquete se encuentra en un estado disfuncional debido a cambios en la base R, las pol√≠ticas de CRAN, las herramientas de CRAN o los paquetes de los que depende.

Si est√° en el proceso de desaprobar una funci√≥n o un argumento, una versi√≥n menor o mayor es un buen momento para considerar avanzar ese proceso como se describe en <<sec-lifecycle-stages-and-package>>. Este tambi√©n es un buen momento para mirar todas las vi√±etas de `NEWS` que se han acumulado desde el √∫ltimo lanzamiento ("`Pulir noticias`"). Incluso si ha sido diligente al anotar todos los cambios dignos de noticia, es probable que estas vi√±etas se beneficien de alguna reorganizaci√≥n y edici√≥n para lograr coherencia y claridad (<<sec-news>>).

Otra comprobaci√≥n muy importante es ejecutar `urlchecker::url++_++check()`. Las comprobaciones de URL de CRAN se describen en https://cran.r-project.org/web/packages/URL_checks.html y se implementan mediante c√≥digo que se incluye con el propio R. Sin embargo, estos controles no se exponen de una manera muy √∫til. El paquete urlchecker se cre√≥ para solucionar este problema y expone la l√≥gica de verificaci√≥n de URL de CRAN en la funci√≥n `url++_++check()`. Los principales problemas que surgen tienden a ser las URL que ya no funcionan o las URL que utilizan la redirecci√≥n. Obviamente, deber√°s actualizar o eliminar cualquier URL que ya no exista. La redirecci√≥n, sin embargo, es m√°s complicada. Si el c√≥digo de estado es "`301 movido permanentemente`", la opini√≥n de CRAN es que su paquete debe usar la URL redirigida. El problema es que muchas personas no siguen https://www.rfc-editor.org/rfc/rfc7231#section-6.4.2[RFC7231] al pie de la letra y utilizan este tipo de redirecci√≥n incluso cuando tienen una intenci√≥n diferente, es decir, su intenci√≥n es proporcionar una URL estable y f√°cil de usar que luego redirige a algo menos f√°cil de usar o m√°s vol√°til. Si una URL leg√≠tima que desea utilizar no cumple con las comprobaciones de CRAN, tendr√° que elegir entre un par de opciones poco atractivas. Podr√≠a intentar explicar la situaci√≥n a CRAN, pero esto requiere una revisi√≥n humana y, por lo tanto, no se recomienda. O puede convertir dichas URL en texto textual sin hiperv√≠nculos. Tenga en cuenta tambi√©n que aunque urlchecker utiliza el mismo _c√≥digo_ que CRAN, sus resultados locales a√∫n pueden diferir de los de CRAN, debido a diferencias en otras condiciones ambientales, como variables de entorno y capacidades del sistema.

Si tiene un archivo `README.Rmd`, tambi√©n querr√° reconstruir el archivo est√°tico `README.md` con la versi√≥n actual de su paquete. La mejor funci√≥n para usar para esto es https://devtools.r-lib.org/reference/build_rmd.html[`devtools::build++_++readme()`], porque se garantiza que renderizar√° `README.Rmd` contra el c√≥digo fuente actual de su paquete.

== Doble `R CMD check`

A continuaci√≥n vienen un par de elementos relacionados con la `R CMD check`. Recuerde que esta no deber√≠a ser la primera vez que ejecuta `R CMD check` desde la versi√≥n anterior. Con suerte, est√° ejecutando `R CMD check` con frecuencia durante el desarrollo local y est√° utilizando un servicio de integraci√≥n continua, como GitHub Actions. Este pretende ser un recordatorio final de √∫ltimo momento para comprobar que todo sigue bien:

* [ ] `devtools::check(remote = TRUE, manual = TRUE)`. Esto sucede en su m√°quina de desarrollo principal, presumiblemente con la versi√≥n actual de R, y con algunas comprobaciones adicionales que generalmente se desactivan para acelerar el desarrollo diario.
* [ ] `devtools::check++_++win++_++devel()`. Esto env√≠a su paquete para que lo verifiquen con el servicio win-builder de CRAN, con la √∫ltima versi√≥n de desarrollo de R (tambi√©n conocido como r-devel). Deber√≠a recibir un correo electr√≥nico en unos 30 minutos con un enlace a los resultados de la verificaci√≥n. Es una buena idea verificar su paquete con r-devel, porque la base R y `R CMD check` est√°n en constante evoluci√≥n. La pol√≠tica de CRAN exige la verificaci√≥n con r-devel y se realizar√° como parte de las verificaciones entrantes de CRAN. No tiene sentido saltarse este paso y esperar lo mejor.

Tenga en cuenta que la brevedad de esta lista refleja impl√≠citamente que los paquetes de tidyverse se verifican despu√©s de cada env√≠o a trav√©s de GitHub Actions, en m√∫ltiples sistemas operativos y versiones de R (incluida la versi√≥n de desarrollo), y que la mayor parte del equipo de tidyverse desarrolla principalmente en macOS. CRAN espera que usted "`haga todos los esfuerzos razonables`" para que su paquete funcione en todas las principales plataformas R y los paquetes que no funcionan en al menos dos normalmente no ser√°n aceptados.

La siguiente subsecci√≥n (<<sec-cran-flavors-services>>) es de lectura opcional con m√°s detalles sobre todas las plataformas que le interesan a CRAN y c√≥mo puede acceder a ellas. Si sus controles continuos son m√°s limitados que los nuestros, es posible que desee compensarlo con controles previos al env√≠o m√°s exhaustivos. Tambi√©n puede necesitar este conocimiento para solucionar un problema concreto que surja en las comprobaciones de CRAN, ya sea para un env√≠o entrante o para un paquete que ya est√° en CRAN.

Al ejecutar `R CMD check` para un env√≠o CRAN, debe solucionar cualquier problema que aparezca:

* Debe corregir todos los "`ERRORES`" y "`ADVERTENCIAS`". CRAN no aceptar√° un paquete que contenga errores o advertencias.
* Eliminar tantas `NOTAS` como sea posible. Cada "`NOTA`" requiere supervisi√≥n humana, lo que crea fricciones tanto para usted como para CRAN. Si hay notas que no cree que sean importantes, casi siempre es m√°s f√°cil arreglarlas (incluso si la soluci√≥n es un poco complicada) que persuadir a CRAN de que est√°n bien. Consulte nuestra https://r-pkgs.org/R-CMD-check.html[gu√≠a solo en l√≠nea sobre `R CMD check`] para obtener detalles sobre c√≥mo solucionar problemas individuales.
* Si no puede eliminar una `NOTA`, incl√∫yala en `cran-comments.md` y explique por qu√© cree que es falsa. Analizaremos este archivo con m√°s detalle en <<sec-release-cran-comments>>.
+
Tenga en cuenta que siempre habr√° una "`NOTA`" cuando env√≠e su paquete por primera vez. Esto le recuerda a CRAN que se trata de un env√≠o nuevo y que necesitar√°n realizar algunas comprobaciones adicionales. No puede eliminar esta "`NOTA`", as√≠ que simplemente mencione en "`cran-comments.md`" que este es su primer env√≠o.

[[sec-cran-flavors-services]]
=== CRAN consulta sabores y servicios relacionados

CRAN ejecuta `R CMD check` en todos los paquetes contribuidos al momento del env√≠o y de forma regular, en m√∫ltiples plataformas o lo que ellos llaman "`sabores`". Puede ver los tipos de cheques actuales de CRAN aqu√≠: https://cran.r-project.org/web/checks/check_flavors.html. Hay varias combinaciones de:

* Sistema operativo y CPU: Windows, macOS (x86++_++64, arm64), Linux (varias distribuciones)
* Versi√≥n R: r-devel, r-release, r-oldrel
* Compiladores C, C{plus}{plus}, FORTRAN
* Configuraci√≥n regional, en el sentido de la variable de entorno `LC++_++CTYPE` (se trata de qu√© lenguaje humano est√° en uso y codificaci√≥n de caracteres)

Es casi seguro que los tipos de verificaci√≥n de CRAN incluyen plataformas distintas a su(s) entorno(s) de desarrollo preferido, por lo que eventualmente necesitar√° hacer un esfuerzo expl√≠cito para verificar y, tal vez, solucionar problemas de su paquete en estos otros tipos.

No ser√≠a pr√°ctico que los desarrolladores de paquetes individuales mantuvieran personalmente todas estas plataformas de prueba. En lugar de eso, recurrimos a varios recursos mantenidos por la comunidad y por CRAN para esto. Aqu√≠ hay una selecci√≥n, en orden de cu√°n centrales son para nuestras pr√°cticas actuales:

* GitHub Actions (GHA) es nuestro medio principal para probar paquetes en m√∫ltiples versiones, como se describe en <<sec-sw-dev-practices-gha>>.
* Constructor de R-hub (R-hub). Este es un servicio respaldado por R Consortium donde los desarrolladores de paquetes pueden enviar su paquete para verificaciones que repliquen varios tipos de verificaci√≥n CRAN.
+
Puede utilizar R-hub a trav√©s de una interfaz web (https://builder.r-hub.io) o, como recomendamos, a trav√©s del https://r-hub.github.io%20/rubo/[paquete Rhub R].
+
`rhub::check++_++for++_++cran()` es una buena opci√≥n para un paquete CRAN t√≠pico y es moralmente similar al flujo de trabajo de GHA configurado por `usethis::use++_++github++_++action("check-standard")`. Sin embargo, a diferencia de GHA, R-hub actualmente no cubre macOS, s√≥lo Windows y Linux.
+
Rhub tambi√©n le ayuda a acceder a algunos de los tipos de cheques m√°s ex√≥ticos y ofrece controles especializados relevantes para paquetes con c√≥digo compilado, como `rhub::check++_++with++_++sanitizers()`.
* El generador de macOS es un servicio mantenido por el personal de CRAN que crea los archivos binarios de macOS para los paquetes de CRAN. Esta es una adici√≥n relativamente nueva a la lista y verifica paquetes con "`la misma configuraci√≥n y paquetes disponibles que la m√°quina de compilaci√≥n CRAN M1`".
+
Puede enviar su paquete usando la interfaz web (https://mac.r-project.org/macbuilder/submit.html) o con `devtools::check++_++mac++_++release()`.

[[sec-release-revdep-checks]]
== Comprobaciones de dependencia inversa

* [ ] `revdepcheck::revdep++_++check(num++_++workers = 4)`

Este elemento inofensivo de la lista de verificaci√≥n puede representar en realidad una cantidad considerable de esfuerzo. En un nivel alto, la verificaci√≥n de sus dependencias inversas ("`revdeps`") se divide en:

* Forme una lista de sus dependencias inversas. Estos son paquetes CRAN que enumeran su paquete en sus campos `Depends`, `Imports`, `Suggests` o `LinkingTo`.
* Ejecute `R CMD check` en cada uno.
* Aseg√∫rese de no haber roto el paquete de otra persona con los cambios planificados en su paquete.

Cada uno de estos pasos puede requerir mucho trabajo y juicio. Por lo tanto, si no tiene dependencias inversas, deber√≠a alegrarse de poder omitir este paso. Si solo tiene un par de dependencias inversas, probablemente pueda hacerlo "`a mano`", es decir, descargar el c√≥digo fuente de cada paquete y ejecutar `R CMD check`.

Aqu√≠ explicamos formas de realizar comprobaciones de dependencia inversa a escala, que es el problema al que nos enfrentamos. Algunos de los paquetes mantenidos por nuestro equipo tienen miles de dependencias inversas e incluso algunos de los paquetes de nivel inferior tienen cientos. Tenemos que abordar esto de forma automatizada y esta secci√≥n ser√° de gran utilidad para otros mantenedores en el mismo barco.

Todas nuestras herramientas de dependencia inversa se concentran en el paquete revdepcheck (https://revdepcheck.r-lib.org/). Tenga en cuenta que, al menos en el momento de escribir este art√≠culo, el paquete revdepcheck no est√° en CRAN. Puedes instalarlo desde Github a trav√©s de `devtools::install++_++github("r-lib/revdepcheck")` o `pak::pak("r-lib/revdepcheck")`.

Haga esto cuando est√© listo para realizar comprobaciones de revdep por primera vez:

[source,r,cell-code]
----
usethis::use_revdep()
----

Esto realiza una configuraci√≥n √∫nica en los archivos `.gitignore` y `.Rbuildignore` de su paquete. La comprobaci√≥n de Revdep crear√° algunas carpetas bastante grandes debajo de `revdep/`, por lo que definitivamente querr√°s configurar estos archivos ignorados. Tambi√©n ver√° este recordatorio para realizar verificaciones de revdep de esta manera, como sugiere el elemento de la lista de verificaci√≥n:

[source,r,cell-code]
----
revdepcheck::revdep_check(num_workers = 4)
----

Esto ejecuta `‚Å†R CMD check‚Å†` en todas sus dependencias inversas, con nuestra recomendaci√≥n de utilizar 4 trabajadores paralelos para acelerar las cosas. La salida se parece a esto:

....
> revdepcheck::revdep_check(num_workers = 4)
‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Computing revdeps ‚îÄ‚îÄ
‚îÄ‚îÄ INSTALL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 2 versions ‚îÄ‚îÄ
Installing CRAN version of cellranger
also installing the dependencies 'cli', 'glue', 'utf8', 'fansi', 'lifecycle', 'magrittr', 'pillar', 'pkgconfig', 'rlang', 'vctrs', 'rematch', 'tibble'

Installing DEV version of cellranger
Installing 13 packages: rlang, lifecycle, glue, cli, vctrs, utf8, fansi, pkgconfig, pillar, magrittr, tibble, rematch2, rematch
‚îÄ‚îÄ CHECK ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 8 packages ‚îÄ‚îÄ
‚úî AOV1R 0.1.0                     ‚îÄ‚îÄ E: 0     | W: 0     | N: 0
‚úî mschart 0.4.0                   ‚îÄ‚îÄ E: 0     | W: 0     | N: 0
‚úî googlesheets4 1.0.1             ‚îÄ‚îÄ E: 0     | W: 0     | N: 1
‚úî readODS 1.8.0                   ‚îÄ‚îÄ E: 0     | W: 0     | N: 0
‚úî readxl 1.4.2                    ‚îÄ‚îÄ E: 0     | W: 0     | N: 0
‚úî readxlsb 0.1.6                  ‚îÄ‚îÄ E: 0     | W: 0     | N: 0
‚úî unpivotr 0.6.3                  ‚îÄ‚îÄ E: 0     | W: 0     | N: 0
‚úî tidyxl 1.0.8                    ‚îÄ‚îÄ E: 0     | W: 0     | N: 0                  
OK: 8                                                                                 
BROKEN: 0
Total time: 6 min
‚îÄ‚îÄ REPORT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Writing summary to 'revdep/README.md'
Writing problems to 'revdep/problems.md'
Writing failures to 'revdep/failures.md'
Writing CRAN report to 'revdep/cran.md'
....

Para minimizar los falsos positivos, `revdep++_++check()` ejecuta `‚Å†R CMD check‚Å†` dos veces por revdep: una vez con la versi√≥n publicada de su paquete actualmente en CRAN y otra vez con la versi√≥n de desarrollo local, es decir, con su versi√≥n candidata. ¬øPor qu√© dos cheques? Porque a veces el revdep ya est√° fallando en la `R CMD check` y ser√≠a incorrecto culpar a la versi√≥n planificada por la falla. `revdep++_++check()` informa los paquetes que no se pueden verificar y, lo m√°s importante, aquellos en los que hay los llamados "`cambios a peor`", es decir, donde su versi√≥n candidata est√° asociada con nuevos problemas. Tenga en cuenta tambi√©n que `revdep++_++check()` siempre funciona con una biblioteca de paquetes temporal e independiente, es decir, no modificar√° su biblioteca de usuario o sistema predeterminada.

[NOTE]
.equipo tidyverse
====
De hecho, utilizamos una funci√≥n diferente para nuestras comprobaciones de dependencia inversa: `revdepcheck::cloud++_++check()`. Esto ejecuta las comprobaciones en la nube, masivamente en paralelo, lo que hace posible ejecutar comprobaciones de revdep para paquetes como testthat (con ++>++10,000 revdeps) en solo unas pocas horas.

`cloud++_++check()` ha cambiado las reglas del juego para nosotros, permiti√©ndonos ejecutar comprobaciones revdep con m√°s frecuencia. Por ejemplo, incluso hacemos esto ahora cuando evaluamos el impacto de un posible cambio en un paquete (<<sec-lifecycle-breaking-change-definition>>), en lugar de hacerlo justo antes de un lanzamiento.

Al momento de escribir este art√≠culo, `cloud++_++check()` solo est√° disponible para los mantenedores de paquetes en Posit, pero esperamos ofrecer este servicio a la comunidad R en general en el futuro.

====

Adem√°s de algunos mensajes interactivos, los resultados de la verificaci√≥n revdep se escriben en la carpeta `revdep/`:

* `revdep/README.md`: Este es un resumen de alto nivel dirigido a mantenedores. El nombre del archivo y el formato Markdown son muy intencionados para crear una buena p√°gina de inicio para la carpeta `revdep/` en GitHub.
* `revdep/problems.md`: enumera los revdeps que parecen estar rotos por su versi√≥n candidata.
* `revdep/failures.md`: enumera los revdep que no se pudieron verificar, generalmente debido a un error de instalaci√≥n, ya sea del propio revdep o de una de sus dependencias.
* `revdep/cran.md`: Este es un resumen de alto nivel dirigido a CRAN. Debes copiar y pegar esto en `cran-comments.md` (<<sec-release-cran-comments>>).
* Otros archivos y carpetas, como `checks.noindex`, `data.sqlite` y `library.noindex`. Estos son para uso interno de revdepcheck y no los discutiremos m√°s.

La forma m√°s sencilla de tener una idea de estos diferentes archivos es consultar los √∫ltimos resultados de revdep para algunos paquetes tidyverse, como https://github.com/tidyverse/dplyr/tree/main/revdep[dplyr] o https://github.com/tidyverse/tidyr/tree/main/revdep[tidyr].

Los resultados de la verificaci√≥n revdep (local, en la nube o CRAN) no son perfectos, porque no es una tarea sencilla. Hay varias razones por las que un resultado puede faltar, ser incorrecto o contradictorio en diferentes ejecuciones.

* Falsos positivos: a veces revdepcheck informa que un paquete se ha roto, pero en realidad todo est√° bien (o, al menos, no peor que antes). Esto ocurre m√°s com√∫nmente debido a pruebas inestables que fallan aleatoriamente (<<sec-testing-advanced-skip-on-cran>>), como las solicitudes HTTP. Esto tambi√©n puede suceder porque la instancia se queda sin espacio en disco u otros recursos, por lo que la primera verificaci√≥n con la versi√≥n CRAN tiene √©xito y la segunda verificaci√≥n con la versi√≥n dev falla. A veces es obvio que el problema no est√° relacionado con su paquete.
* Falsos negativos: a veces se ha roto un paquete, pero no lo detectas. Para nosotros, esto suele suceder cuando `cloud++_++check()` no puede verificar un revdep porque no se puede instalar, generalmente debido a que falta un requisito del sistema (por ejemplo, Java). Estos se informan por separado como "`no se pudo probar`", pero a√∫n se incluyen en `problems.md`, porque a√∫n podr√≠a tratarse de una rotura directa causada por su paquete. Por ejemplo, si elimina una funci√≥n exportada que utiliza otro paquete, la instalaci√≥n fallar√°.

En general, estas diferencias son menos preocupantes ahora que las propias comprobaciones de revdep de CRAN est√°n bien automatizadas, por lo que las nuevas fallas normalmente no involucran a un humano.

=== Revdeps y cambios importantes

Si la verificaci√≥n revdep revela roturas, debe examinar cada falla y determinar si se trata de:

* Un falso positivo.
* Un cambio continuo, es decir, una falla causada por el uso no autorizado de su paquete.
* Un error en tu paquete que necesitas corregir.
* Un cambio radical deliberado.

Si su actualizaci√≥n romper√° otro paquete (independientemente del motivo), debe informar al mantenedor, para que √©l lo escuche primero de usted, en lugar de CRAN. La mejor manera de hacerlo es con un parche que actualice su paquete para que funcione bien con el suyo, tal vez en forma de solicitud de extracci√≥n. Esto puede suponer una cantidad decente de trabajo y ciertamente no es factible para todos los mantenedores. Pero resolver algunos de ellos puede ser una buena manera de enfrentar el dolor que causa el cambio radical y reconsiderar si los beneficios superan los costos. En la mayor√≠a de los casos, es probable que un cambio que afecte a los revdeps tambi√©n rompa el c√≥digo menos visible que se encuentra fuera de los paquetes CRAN, como scripts, informes y aplicaciones Shiny.

Si decide continuar, funciones como `revdepcheck::revdep++_++maintainers()` y `revdepcheck::revdep++_++email()` pueden ayudarle a notificar a los mantenedores de revdep _en masa_. Aseg√∫rese de que el correo electr√≥nico incluya un enlace a la documentaci√≥n que describa los cambios importantes m√°s comunes y c√≥mo solucionarlos. Debe informar a los mantenedores cu√°ndo planea enviar su versi√≥n a CRAN (recomendamos avisar con al menos dos semanas de anticipaci√≥n), para que puedan enviar su versi√≥n actualizada antes de eso. Cuando llegue la fecha de lanzamiento, vuelva a ejecutar sus comprobaciones para ver cu√°ntos problemas se han resuelto. Explique cualquier falla restante en `cran-comments.md` como se demuestra en <<sec-release-cran-comments>>. Los dos casos m√°s comunes son que no puede verificar un paquete porque no puede instalarlo localmente o un cambio leg√≠timo en la API que el mantenedor a√∫n no ha abordado. Siempre que haya avisado con suficiente antelaci√≥n, CRAN aceptar√° su actualizaci√≥n, incluso si da√±a otros paquetes.

[NOTE]
.equipo tidyverse
====
√öltimamente, el equipo de tidyverse est√° tratando de cumplir con los mantenedores de revdep a m√°s de la mitad del camino en t√©rminos de lidiar con cambios importantes. Por ejemplo, en el problema de GitHub https://github.com/tidyverse/dplyr/issues/6262[tidyverse/dplyr#6262], los mantenedores de dplyr rastrearon cientos de solicitudes de extracci√≥n en el per√≠odo previo al lanzamiento de dplyr v1. .1.0. A medida que se crean los RP, tambi√©n es √∫til agregar enlaces a ellos. A medida que los mantenedores de revdep fusionan los RP, se pueden marcar como resueltos. Si algunos RP todav√≠a est√°n en proceso cuando llega la fecha de env√≠o anunciada, la situaci√≥n se puede resumir en `cran-comments.md`, como fue el caso de https://github.%20com/tidyverse/dplyr/blob/c7e9cd72fd86309d72f2c522157cfac38f45453b/cran-comments.md[dplyr v1.1.0].
====

[[sec-release-cran-comments]]
== Actualizar comentarios para CRAN

* [ ] Actualizar `cran-comments.md`

Usamos el archivo `cran-comments.md` para registrar comentarios sobre un env√≠o, principalmente solo los resultados de `R CMD check` y controles revdep. Si est√° realizando un cambio espec√≠fico a solicitud de CRAN, posiblemente dentro de una fecha l√≠mite, tambi√©n tendr√≠a sentido mencionarlo. Nos gusta realizar un seguimiento de este archivo en Git, para poder ver c√≥mo cambia con el tiempo. Tambi√©n deber√≠a aparecer en `.Rbuildignore`, ya que no deber√≠a aparecer en su paquete. Cuando est√© listo para enviar, `devtools::submit++_++cran()` (<<sec-release-process>>) incorpora el contenido de `cran-comments.md` cuando carga su env√≠o.

El p√∫blico objetivo de estos comentarios es el personal de CRAN, aunque no hay garant√≠a de que lean los comentarios (o cuando en el proceso de env√≠o los lean). Por ejemplo, si su paquete rompe otros paquetes, probablemente recibir√° un correo electr√≥nico autom√°tico al respecto, incluso si lo ha explicado en los comentarios. A veces, un humano de CRAN lee los comentarios, queda satisfecho y acepta su paquete de todos modos, sin ninguna otra acci√≥n por su parte. En otras ocasiones, su paquete puede quedarse atascado en la cola hasta que copie `cran-comments.md` y lo pegue en un intercambio de correo electr√≥nico para avanzar. En cualquier caso, vale la pena mantener estos comentarios en su propio archivo controlado por versi√≥n.

Aqu√≠ hay un `cran-comments.md` bastante t√≠pico de una versi√≥n reciente de forcats. Tenga en cuenta que los resultados de la `R CMD check` son limpios, es decir, no hay nada que deba explicarse o justificarse, y hay un resumen conciso del proceso revdep.

[source,md]
----
## R CMD check results

0 errors | 0 warnings | 0 notes

## revdepcheck results

We checked 231 reverse dependencies (228 from CRAN + 3 from Bioconductor), comparing R CMD check results across CRAN and dev versions of this package.

We saw 2 new problems:

* epikit
* stevemisc

Both maintainers were notified on Jan 12 (~2 week ago) and supplied with patches.

We failed to check 3 packages

* genekitr     (NA)
* OlinkAnalyze (NA)
* SCpubr       (NA)
----

Este dise√±o est√° dise√±ado para que sea f√°cil de leer y f√°cil de comparar con los resultados de la `R CMD check` vistos por los mantenedores de CRAN. Incluye dos secciones:

[arabic]
. Verificar resultados: Siempre afirmamos que no hubo errores ni advertencias (¬°y nos aseguramos de que sea cierto!). Idealmente tambi√©n podemos decir que no hubo notas. Pero si no, las `NOTES` se presentan en una lista con vi√±etas. Para cada `NOTA`, incluimos el mensaje de `R CMD check` y una breve descripci√≥n de por qu√© creemos que est√° bien.
+
A continuaci√≥n se explica c√≥mo se explica una `NOTA` para el paquete de datos nycflights13:
+
[source,md]
----
## R CMD check results

0 errors | 0 warnings | 1 note

* Checking installed package size:
  installed size is  6.9Mb
  sub-directories of 1Mb or more:
    data   6.9Mb

  This is a data package that will be rarely updated.
----
. Dependencias inversas: si hay revdeps, aqu√≠ es donde pegamos el contenido de `revdep/cran.md` (<<sec-release-revdep-checks>>). Si no hay revdeps, le recomendamos que mantenga esta secci√≥n, pero diga algo como: "`Actualmente no hay dependencias posteriores para este paquete`".

[[sec-release-process]]
== El proceso de env√≠o

* [ ] `usethis::use++_++version('minor')` (o '`patch`' o '`major`')
* [ ] `devtools::submit++_++cran()`
* [ ] Aprobar correo electr√≥nico

Cuando est√© realmente listo para enviar, es hora de aumentar el n√∫mero de versi√≥n en DESCRIPCI√ìN. Este elemento de la lista de verificaci√≥n reflejar√° el tipo de lanzamiento declarado al inicio de este proceso (parche, menor o mayor), en la llamada inicial a `use++_++release++_++issue()`.

Le recomendamos que env√≠e su paquete a CRAN llamando a `devtools::submit++_++cran()`. Esta funci√≥n de conveniencia resume algunos pasos:

* Crea el paquete (<<sec-bundled-package>>) con `pkgbuild::build(manual = TRUE)`, que finalmente llama a `R CMD build`.
* Publica el archivo `++*++.tar.gz` resultante en el formulario de env√≠o oficial de CRAN (https://cran.r-project.org/submit.html), completando su nombre y correo electr√≥nico desde `DESCRIPCI√ìN` y sus comentarios de env√≠o. de `cran-comments.md`.
* Confirma que el env√≠o fue exitoso y le recuerda que revise su correo electr√≥nico para ver el enlace de confirmaci√≥n.
* Escribe los detalles del env√≠o en un archivo local `CRAN-SUBMISSION`, que registra la versi√≥n del paquete, SHA y la hora del env√≠o. Esta informaci√≥n la utiliza m√°s adelante `usethis::use++_++github++_++release()` para crear una versi√≥n de GitHub una vez que su paquete haya sido aceptado. `CRAN-SUBMISSION` se agregar√° a `.Rbuildignore`. Generalmente no ignoramos este archivo, pero tampoco lo confirmamos. Es una nota ef√≠mera que existe durante el intervalo entre la presentaci√≥n y (con suerte) la aceptaci√≥n.

Despu√©s de una carga exitosa, deber√≠a recibir un correo electr√≥nico de CRAN en unos minutos. Este correo electr√≥nico le notifica a usted, como mantenedor, del env√≠o y proporciona un enlace de confirmaci√≥n. Parte de lo que esto hace es confirmar que la direcci√≥n de correo electr√≥nico del mantenedor es correcta. En el enlace de confirmaci√≥n, deber√° volver a confirmar que ha seguido las pol√≠ticas de CRAN y que desea enviar el paquete. Si no completa este paso, ¬°su paquete en realidad no se env√≠a a CRAN!

Una vez que su paquete ingresa al sistema de CRAN, se verifica autom√°ticamente en Windows y Linux, probablemente con las versiones lanzadas y de desarrollo de R. Recibir√° otro correo electr√≥nico con enlaces a los resultados de estas comprobaciones, normalmente en cuesti√≥n de horas. Una presentaci√≥n inicial (<<sec-release-initial>>) recibir√° un escrutinio adicional por parte del personal de CRAN. El proceso est√° potencialmente completamente automatizado cuando se actualiza un paquete que ya est√° en CRAN. Si la actualizaci√≥n de un paquete pasa sus comprobaciones iniciales, CRAN ejecutar√° comprobaciones de dependencia inversa.

== Modos de fallo

Hay al menos tres formas de que falle el env√≠o de CRAN:

* No pasa `R CMD check`. Este es un resultado automatizado.
* La revisi√≥n humana determina que el paquete infringe las pol√≠ticas de CRAN. Esto se aplica principalmente a los env√≠os iniciales, pero a veces el personal de CRAN decide participar en una revisi√≥n _ad hoc_ de actualizaciones de paquetes existentes que no superan las comprobaciones autom√°ticas.
* Las comprobaciones de dependencia inversa sugieren que hay "`cambios a peor`". Este es un resultado automatizado.

Los fracasos son frustrantes y la retroalimentaci√≥n puede ser cortante y francamente insultante. Si√©ntase c√≥modo sabiendo que esta es una experiencia ampliamente compartida en toda la comunidad R. Nos pasa habitualmente. No se apresure a responder, especialmente si se siente a la defensiva.

Espere hasta que pueda centrar su atenci√≥n en los problemas t√©cnicos que se han planteado. Lea atentamente los resultados de las comprobaciones o los correos electr√≥nicos e investigue los hallazgos. A menos que crea firmemente que se merece la discusi√≥n, no responda el correo electr√≥nico. En cambio:

* Solucione los problemas identificados y realice los cambios recomendados. Vuelva a ejecutar `devtools::check()` en cualquier plataforma relevante para asegurarse de no introducir accidentalmente ning√∫n problema nuevo.
* Aumente la versi√≥n de parche de su paquete. S√≠, esto significa que puede haber lagunas en los n√∫meros de versi√≥n publicada. Esto no es gran cosa.
* Agregue una secci√≥n "`Resubmission`" en la parte superior de `cran-comments.md`. Esto deber√≠a identificar claramente que el paquete es un reenv√≠o y enumerar los cambios que realiz√≥.
+
[source,md]
----
## Resubmission
This is a resubmission. In this version I have:

* Converted the DESCRIPTION title to title case.

* More clearly identified the copyright holders in the DESCRIPTION
  and LICENSE files.
----
* Si es necesario, actualice las secciones de resultados de verificaci√≥n y revisi√≥n.
* Ejecute `devtools::submit++_++cran()` para volver a enviar el paquete.

Si su an√°lisis indica que el error inicial fue un falso positivo, responda al correo electr√≥nico de CRAN con una explicaci√≥n concisa. Para nosotros, este escenario surge principalmente con respecto a los controles de revdep. Es extremadamente raro que veamos fallas en las ejecuciones iniciales de `R CMD check` de CRAN y, cuando sucede, a menudo es leg√≠tima. Por otro lado, para paquetes con una gran cantidad de revdeps, es inevitable que un subconjunto de estos paquetes tenga algunas pruebas inestables o ejemplos fr√°giles. Por lo tanto, es bastante com√∫n ver fallas de revdep que no tienen nada que ver con la actualizaci√≥n del paquete propuesta. En este caso, lo adecuado es enviar un correo electr√≥nico de respuesta a CRAN explicando por qu√© cree que se trata de falsos positivos.

[[sec-release-post-acceptance]]
== Celebrando el √©xito

Ahora pasamos a la secci√≥n m√°s feliz de la lista de verificaci√≥n.

* [ ] Aceptada üéâ
* [ ] Termina y publica en blog
* [ ] A√±ade link de la punlicaci√≥n en `pkgdown` news menu
* [ ] `usethis::use++_++github++_++release()`
* [ ] `usethis::use++_++dev++_++version(push = TRUE)`
* [ ] `git push`
* [ ] Compartir en las redes sociales

CRAN le notificar√° por correo electr√≥nico una vez que su paquete sea aceptado. Este es un buen momento para terminar una entrada de blog, si es relevante. `usethis::use++_++github++_++release()` realiza un par de cosas importantes. En primer lugar, es cuando subimos por primera vez a GitHub el nuevo n√∫mero de versi√≥n; es decir, esperamos hasta que estemos seguros de que esta versi√≥n se publicar√° en CRAN. Esta funci√≥n tambi√©n crea una versi√≥n de GitHub correspondiente a esta versi√≥n de CRAN. Una versi√≥n de GitHub es b√°sicamente una etiqueta de Git glorificada. El √∫nico aspecto de las versiones de GitHub que aprovechamos regularmente son las notas de la versi√≥n. `usethis::use++_++github++_++release()` crea notas de la versi√≥n a partir de las vi√±etas `NEWS` relevantes para la versi√≥n actual. Tenga en cuenta que `usethis::use++_++github++_++release()` depende crucialmente del archivo `CRAN-SUBMISSION` que fue escrito por `devtools::submit++_++cran()`: as√≠ es como sabe qu√© SHA etiquetar. Despu√©s de la creaci√≥n exitosa de la versi√≥n de GitHub, `use++_++github++_++release()` elimina este archivo temporal.

Ahora nos preparamos para la pr√≥xima versi√≥n incrementando el n√∫mero de versi√≥n una vez m√°s, esta vez a una versi√≥n de desarrollo usando `usethis::use++_++dev++_++version()`. Tiene sentido enviar inmediatamente este estado a GitHub para que, por ejemplo, cualquier rama nueva o solicitud de extracci√≥n tenga claramente una versi√≥n de desarrollo como base.

Una vez que CRAN acepta el paquete, se crean archivos binarios para macOS y Windows. Tambi√©n se verificar√° en el panel de tipos de verificaci√≥n CRAN. Estos procesos se desarrollan a lo largo de unos d√≠as, despu√©s de la aceptaci√≥n, y a veces descubren errores que no fueron detectados por las comprobaciones entrantes menos exhaustivas. Es una buena idea visitar la p√°gina de inicio de CRAN de su paquete unos d√≠as despu√©s del lanzamiento y asegurarse de que todo parezca estar bien. <<fig-cran-checks>> resalta d√≥nde est√°n vinculados estos resultados desde una p√°gina de inicio de CRAN.

.Enlace a los resultados de la verificaci√≥n CRAN.
[#fig-cran-checks]
image::images/cran-checks-usethis.png[images/cran-checks-usethis]

Si hay un problema, prepare una versi√≥n de parche para solucionarlo y env√≠elo utilizando el mismo proceso que antes. Si esto significa que va a realizar un segundo env√≠o menos de una semana despu√©s del anterior, explique la situaci√≥n en `cran-comments.md`. Lograr que un paquete se establezca en CRAN puede llevar un par de rondas, aunque la orientaci√≥n de este cap√≠tulo tiene como objetivo maximizar las posibilidades de √©xito en el primer intento. Las versiones futuras, iniciadas por usted, deben tener un intervalo de al menos uno o dos meses, de acuerdo con la pol√≠tica de CRAN.

Una vez que los binarios de su paquete est√©n creados y hayan pasado las comprobaciones de los distintos tipos de CRAN, es hora de la parte divertida: dar a conocer su paquete. Esto adopta diferentes formas, seg√∫n el tipo de liberaci√≥n. Si este es su lanzamiento inicial (o, al menos, el primer lanzamiento para el que realmente desea atraer usuarios), es especialmente importante correr la voz. Nadie utilizar√° su nuevo y √∫til paquete si no sabe que existe. Hay varios lugares para anunciar su paquete, como Twitter, Mastodon, LinkedIn, comunidades de Slack, etc. Aseg√∫rese de utilizar etiquetas relevantes, como el hashtag #rstats. Si tienes un blog, es una gran idea escribir una publicaci√≥n sobre tu lanzamiento.

Al presentar un paquete, la sensaci√≥n deber√≠a ser bastante similar a escribir su `README` o una vi√±eta de "`Introducci√≥n`". Aseg√∫rese de describir lo que hace el paquete, para que las personas que no lo hayan usado antes puedan entender por qu√© deber√≠a importarles. Para los paquetes existentes, tendemos a escribir publicaciones de blog para versiones menores y principales, pero no para una versi√≥n de parche. En todos los casos, encontramos que estas publicaciones de blog son m√°s efectivas cuando incluyen muchos ejemplos, es decir, "`muestre, no cuente`". Para actualizaciones de paquetes, recuerde que la existencia de un archivo completo `NEWS` lo libera de la necesidad de enumerar hasta el √∫ltimo cambio en la publicaci√≥n de su blog. En su lugar, puede centrarse en los cambios m√°s importantes y vincular a las notas de la versi√≥n completas, para aquellos que quieran conocer los detalles sangrientos.

Si escribe un blog sobre su paquete, es bueno capturarlo como otra documentaci√≥n m√°s en su sitio web de pkgdown. Un sitio t√≠pico de pkgdown tiene un elemento de "`News`" en la barra de navegaci√≥n superior, que enlaza con un "`Changelog`" que se crea a partir de `NEWS.md`. Este men√∫ desplegable es un lugar com√∫n para insertar enlaces a cualquier publicaci√≥n de blog sobre el paquete. Puedes lograr esto teniendo YAML como este en tu archivo de configuraci√≥n `++_++pkgdown.yml`:

[source,yaml]
----
news:
  releases:
  - text: "Renaming the default branch (usethis >= 2.1.2)"
    href: https://www.tidyverse.org/blog/2021/10/renaming-default-branch/
  - text: "usethis 2.0.0"
    href: https://www.tidyverse.org/blog/2020/12/usethis-2-0-0/
  - text: "usethis 1.6.0"
    href: https://www.tidyverse.org/blog/2020/04/usethis-1-6-0/
----

¬°Felicidades! ¬°Has lanzado tu primer paquete a CRAN y has llegado al final del libro!
